<!DOCTYPE html>
<html>

<head>
    <title> To-do list </title>
    <link rel="stylesheet" type="text/css" href="css/main.css">
</head>

<body>
    <div id="container">
        <div id="add"></div>
        <div id="remove"></div>
        <div id="toDo"></div>
    </div>
    <script>
    class ToDo {
        constructor() {
            this._items = []
            this._currItem = null
            this._top = 0
            this._dependencies = []
        }

        get item() {
            return this._items
        }

        set item(val) {
            this._currItem = val

            if (this._currItem != null)
                this._items.push(val)

            this._dependencies.forEach(f => {
                f(this)
            })

            this._currItem = null
        }

        addDependency(f) {
            this._dependencies.push(f)
        }
    }

    // New todo list
    var toDoItem = new ToDo()

    // Add and remove items
    toDoItem.addDependency((list) => {

        var parent = document.getElementById('toDo')

        // add item
        if (list._currItem != null) {
            var p = document.createElement('p')
            p.setAttribute('contenteditable', 'true')
            p.textContent = list._items[list._top++]
            parent.appendChild(p)
        }
        // remove item
        else if (list._currItem == null && parent.hasChildNodes()) {
            parent.removeChild(parent.lastChild);
            list._items.pop()
            list._top--
        }
    });

    // When the user clicks on the green button
    document.getElementById('add').addEventListener('click', function(event) {
        var newItem = prompt("Enter the item");
        toDoItem.item = newItem;
    });

	// When the user clicks on the red button
    document.getElementById('remove').addEventListener('click', function(event) {
        toDoItem.item = null;
    });
    </script>
</body>

</html>
